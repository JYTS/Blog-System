<!-- 前端 HTML 代码 -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/login.css">
  
  <title>Login System</title>
</head>
<body>
  <div class="login-container">
    <h2>Login</h2>
    <form id="login-form">
      <div class="form-group">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required>
      </div>
      <div class="form-group">
        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required>
      </div>
      <div class="form-group">
        <input type="submit" value="Login">
      </div>
    </form>
    <div class="form-group">
      <a href="register.html">Register</a>
    </div>
    <div id="error-message"></div>
  </div>

  <script>
    document.getElementById('login-form').addEventListener('submit', function(event)
     {
      event.preventDefault();

      // 获取用户名和密码输入框的值
      var username = document.getElementById('username').value;
      var password = document.getElementById('password').value;

      // 构建要发送的 JSON 对象
      const data = { username, password };
      // console.log("Sending JSON data:", data);

      // 创建 XMLHttpRequest 对象
      const xhr = new XMLHttpRequest();




//       1 用户登录

// **请求**

// - 方法: POST

// -  URL: http://127.0.0.1:8080/Blog-System/user/login

// **请求体**

// | 字段名   | 格式   | 是否必需 | 简介   |
// | -------- | ------ | -------- | ------ |
// | username | String | T        | 用户名 |
// | password | String | T        | 密码   |

// **响应**

// - 成功响应（200）


// - 错误响应（101-103）
      xhr.open("POST", "http://127.0.0.1:8080/Blog-System/user/login", true);
      xhr.setRequestHeader("Content-Type", "application/json");

      // 定义请求完成时的回调函数
      xhr.onload = function () 
      {
        if (xhr.status === 200) {
          // 登录成功
          




          sessionStorage.setItem('username', username);


          // 重定向到另一个页面，带上用户名作为查询参数
          window.location.href = 'index.html'
          // window.location.href = 'test.html'
          alert('Login successful!');
          
        } else {
          // 登录失败，显示错误消息
          document.getElementById('error-message').innerHTML = 'Invalid username or password.';
        }
      };

      // 发送请求，并将 JSON 对象转换为字符串
      xhr.send(JSON.stringify(data));
    });
  </script>
</body>
</html>
